<div class="shop-card" style="background-image: url('<%= cl_image_path @shop.photos.first.key %>');">
  <div class="shop-card-text">
      <h1><%= @shop.name %></h1>
      <h4>Address: <%= @shop.address %></h4>
      <h4>Phone Number: <%= @shop.phone_number %></h4>
      <% if policy(@shop).edit? %>
      <%= link_to "Edit this shop", edit_shop_path(@shop), class: "btn"%>
      <%= button_to "Delete my shop", @shop, class:"btn", method: :delete if policy(@shop).destroy?%>
      <% end %>
  </div>
</div>
<div class="container">
  <div class="pending-reservations">

    <div data-controller="collapsable-cards">
      <% @reservations.each do |reservation| %>
        <div class="reservations">
          <h2>Reservation ID: <%= reservation.id %></h2>
          <p class="reservations-status">Items: <%= reservation.reservation_products.count %></p>
          <p class="reservations-status">Status: <%= reservation.status %></p>
          <p class="reservations-status">Created at: <%= reservation.created_at.strftime("%m/%d/%Y %H:%M") %></p>
          <button data-action="click->collapsable-cards#toggle" data-reservation="<%= reservation.id %>">Show items:</button>
        </div>
        <hr>

        <div data-collapsable-cards-target="cards" class="hidden" data-cards="<%= reservation.id %>">
        <% reservation.reservation_products.each do |product| %>

          <div class="reservation-items">
            <%= cl_image_tag product.product.photos.first.key, class: "text", height: 100, width: 150, crop: :fill %>
            <p class="reservations-text"><%= product.product.name %></p>
            <p class="reservations-status">Status: <%= product.reservation.status %></p>
                <%= simple_form_for product.reservation, data: { turbo_method: "patch" } do |f| %>
                  <%= f.input :status, collection: Reservation.statuses.keys, prompt: "Update status" %>
                  <%= f.button :submit %>
                <% end %>
          </div>
          <hr>

        <% end %>
          </div>
        <% end %>
    </div>
  </div>
</div>
